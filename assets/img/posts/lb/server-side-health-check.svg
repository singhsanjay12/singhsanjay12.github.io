<svg width="800" height="270" viewBox="0 0 800 270" xmlns="http://www.w3.org/2000/svg" font-family="'Segoe UI',system-ui,sans-serif">
  <defs>
    <linearGradient id="bg" x1="0" y1="0" x2="1" y2="1" gradientUnits="objectBoundingBox">
      <stop offset="0%" stop-color="#eef2ff"/>
      <stop offset="100%" stop-color="#f8fafc"/>
    </linearGradient>
    <marker id="arrowB" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#4f8ef7"/>
    </marker>
    <marker id="arrowO" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#f59e0b"/>
    </marker>
    <filter id="sh">
      <feDropShadow dx="0" dy="2" stdDeviation="3" flood-color="#00000018"/>
    </filter>
  </defs>

  <rect width="800" height="270" fill="url(#bg)"/>

  <!-- Title -->
  <text x="400" y="24" text-anchor="middle" fill="#1e293b" font-size="14" font-weight="700">Health Checking in Server-Side Load Balancing</text>

  <!-- ── Load Balancer box ── -->
  <rect x="40" y="42" width="340" height="188" rx="10" fill="white" stroke="#4f8ef7" stroke-width="2" filter="url(#sh)"/>
  <!-- Header band -->
  <path d="M52,42 L368,42 Q380,42 380,54 L380,72 L40,72 L40,54 Q40,42 52,42 Z" fill="#4f8ef7"/>
  <text x="210" y="62" text-anchor="middle" fill="white" font-size="12" font-weight="700">Load Balancer</text>

  <!-- Health check config -->
  <text x="58" y="92"  fill="#374151" font-size="9.5" font-weight="700">Health Check Loop</text>
  <text x="58" y="108" fill="#64748b" font-size="9">Probe: GET /health  ·  every 5 s per instance</text>
  <text x="58" y="123" fill="#64748b" font-size="9">Timeout: 2 s  ·  Rise: 2 success  ·  Fall: 3 failures</text>

  <!-- Divider -->
  <line x1="58" y1="135" x2="362" y2="135" stroke="#e2e8f0" stroke-width="1"/>

  <!-- Instance 3 status -->
  <text x="58" y="153" fill="#374151" font-size="9.5" font-weight="700">Current status</text>
  <text x="58" y="169" fill="#64748b" font-size="9">Instance 1  ✓  healthy</text>
  <text x="58" y="183" fill="#64748b" font-size="9">Instance 2  ✓  healthy</text>
  <text x="58" y="197" fill="#f59e0b" font-size="9" font-weight="600">Instance 3  ✗  1 of 3 failures — still in rotation</text>
  <text x="58" y="213" fill="#94a3b8" font-size="8.5" font-style="italic">removed after 3rd consecutive failure</text>

  <!-- ── Health check arrows → instances ── -->
  <!-- To Instance 1 (green) -->
  <line x1="382" y1="82"  x2="538" y2="82"  stroke="#4f8ef7" stroke-width="1.6" stroke-dasharray="5 3" marker-end="url(#arrowB)"/>
  <text x="460" y="76" text-anchor="middle" fill="#4f8ef7" font-size="8">GET /health</text>

  <!-- To Instance 2 (green) -->
  <line x1="382" y1="152" x2="538" y2="152" stroke="#4f8ef7" stroke-width="1.6" stroke-dasharray="5 3" marker-end="url(#arrowB)"/>
  <text x="460" y="146" text-anchor="middle" fill="#4f8ef7" font-size="8">GET /health</text>

  <!-- To Instance 3 (orange/warn) -->
  <line x1="382" y1="207" x2="538" y2="207" stroke="#f59e0b" stroke-width="1.6" stroke-dasharray="5 3" marker-end="url(#arrowO)"/>
  <text x="460" y="201" text-anchor="middle" fill="#f59e0b" font-size="8">GET /health</text>

  <!-- ── Instance boxes ── -->
  <!-- Instance 1: healthy -->
  <rect x="540" y="58" width="210" height="48" rx="8" fill="#f0fff4" stroke="#27ae60" stroke-width="1.8" filter="url(#sh)"/>
  <text x="645" y="79"  text-anchor="middle" fill="#166534" font-size="10" font-weight="700">Instance 1</text>
  <text x="645" y="95"  text-anchor="middle" fill="#27ae60" font-size="9" font-weight="600">✓  200 OK</text>

  <!-- Instance 2: healthy -->
  <rect x="540" y="128" width="210" height="48" rx="8" fill="#f0fff4" stroke="#27ae60" stroke-width="1.8" filter="url(#sh)"/>
  <text x="645" y="149" text-anchor="middle" fill="#166534" font-size="10" font-weight="700">Instance 2</text>
  <text x="645" y="165" text-anchor="middle" fill="#27ae60" font-size="9" font-weight="600">✓  200 OK</text>

  <!-- Instance 3: timeout -->
  <rect x="540" y="183" width="210" height="48" rx="8" fill="#fffbeb" stroke="#f59e0b" stroke-width="1.8" filter="url(#sh)"/>
  <text x="645" y="204" text-anchor="middle" fill="#92400e" font-size="10" font-weight="700">Instance 3</text>
  <text x="645" y="220" text-anchor="middle" fill="#f59e0b" font-size="9" font-weight="600">✗  timeout</text>

  <!-- Caption -->
  <text x="400" y="260" text-anchor="middle" fill="#94a3b8" font-size="9" font-style="italic">With interval=5s and fall=3, hard failure detection can take up to 15 seconds.</text>
</svg>
