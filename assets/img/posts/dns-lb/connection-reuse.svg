<svg width="800" height="420" viewBox="0 -25 800 420" xmlns="http://www.w3.org/2000/svg" font-family="'Segoe UI',system-ui,sans-serif">
  <defs>
    <style>
      @keyframes dash  { to { stroke-dashoffset: -20; } }
      @keyframes pulse { 0%,100%{opacity:1;} 50%{opacity:0.3;} }
      .flow  { animation: dash  1.6s linear      infinite; }
      .blink { animation: pulse 1.2s ease-in-out infinite; }
    </style>
    <linearGradient id="bg" x1="0" y1="0" x2="1" y2="1" gradientUnits="objectBoundingBox">
      <stop offset="0%" stop-color="#eef2ff"/>
      <stop offset="100%" stop-color="#f8fafc"/>
    </linearGradient>
    <filter id="shadow">
      <feDropShadow dx="0" dy="2" stdDeviation="3" flood-color="#00000018"/>
    </filter>
    <filter id="glow-r">
      <feGaussianBlur stdDeviation="3" result="blur"/>
      <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
    <marker id="mb" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto">
      <path d="M0,0 L0,6 L7,3 z" fill="#4f8ef7"/>
    </marker>
    <marker id="mr" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto">
      <path d="M0,0 L0,6 L7,3 z" fill="#e74c3c"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect x="0" y="-25" width="800" height="420" fill="url(#bg)"/>

  <!-- Dot grid -->
  <g fill="#c7d2fe" opacity="0.4">
    <g id="dc">
      <circle cx="0" cy="0" r="1.5"/><circle cx="0" cy="40" r="1.5"/>
      <circle cx="0" cy="80" r="1.5"/><circle cx="0" cy="120" r="1.5"/>
      <circle cx="0" cy="160" r="1.5"/><circle cx="0" cy="200" r="1.5"/>
      <circle cx="0" cy="240" r="1.5"/><circle cx="0" cy="280" r="1.5"/>
      <circle cx="0" cy="320" r="1.5"/>
    </g>
    <use href="#dc" x="40"/><use href="#dc" x="80"/><use href="#dc" x="120"/>
    <use href="#dc" x="160"/><use href="#dc" x="200"/><use href="#dc" x="240"/>
    <use href="#dc" x="280"/><use href="#dc" x="320"/><use href="#dc" x="360"/>
    <use href="#dc" x="400"/><use href="#dc" x="440"/><use href="#dc" x="480"/>
    <use href="#dc" x="520"/><use href="#dc" x="560"/><use href="#dc" x="600"/>
    <use href="#dc" x="640"/><use href="#dc" x="680"/><use href="#dc" x="720"/>
    <use href="#dc" x="760"/>
  </g>

  <!-- Top banner -->
  <rect x="0" y="-25" width="800" height="35" fill="#1e293b" opacity="0.85"/>
  <text x="400" y="-3" text-anchor="middle" fill="white" font-size="10" font-weight="700">T = 70s  ·  DNS updated  ·  10.0.1.4 terminated  ·  10.0.1.8 registered</text>

  <!-- Center divider -->
  <line x1="400" y1="20" x2="400" y2="320" stroke="#e2e8f0" stroke-width="1.5" stroke-dasharray="5 4"/>

  <!-- ════ LEFT COLUMN: Client A — old connection ════ -->

  <!-- Column header -->
  <rect x="15" y="18" width="370" height="28" rx="7" fill="#fff0f0" stroke="#fca5a5" stroke-width="1"/>
  <text x="200" y="36" text-anchor="middle" fill="#c0392b" font-size="9.5" font-weight="700">Client A  ·  connected at T = 0</text>

  <!-- Client A box -->
  <rect x="55" y="58" width="180" height="38" rx="8" fill="white" stroke="#4f8ef7" stroke-width="1.8" filter="url(#shadow)"/>
  <text x="145" y="74" text-anchor="middle" fill="#4f8ef7" font-size="10" font-weight="700">Client A</text>
  <text x="145" y="88" text-anchor="middle" fill="#94a3b8" font-size="8">open connection since T=0</text>

  <!-- "DNS says" side note -->
  <rect x="255" y="62" width="122" height="42" rx="8" fill="white" stroke="#cbd5e1" stroke-width="1" filter="url(#shadow)"/>
  <polygon points="255,83 242,79 255,88" fill="white"/>
  <polygon points="255,83 242,79 255,88" fill="none" stroke="#cbd5e1" stroke-width="1"/>
  <text x="316" y="77" text-anchor="middle" fill="#64748b" font-size="8" font-weight="600">DNS now:</text>
  <text x="316" y="90" text-anchor="middle" fill="#64748b" font-size="8" font-family="monospace">10.0.1.8</text>
  <!-- Ignored badge -->
  <circle cx="372" cy="62" r="9" fill="#fee2e2" stroke="#fca5a5" stroke-width="1"/>
  <text x="372" y="66" text-anchor="middle" fill="#c0392b" font-size="10" font-weight="700">✕</text>

  <!-- Explanation box -->
  <rect x="25" y="112" width="360" height="36" rx="7" fill="#fff7ed" stroke="#f97316" stroke-width="1"/>
  <text x="205" y="127" text-anchor="middle" fill="#c2410c" font-size="8.5" font-weight="600">Connection already open · pool does not re-resolve</text>
  <text x="205" y="141" text-anchor="middle" fill="#9a3412" font-size="8">DNS update is invisible to established TCP connections</text>

  <!-- Arrow down to instance -->
  <line x1="145" y1="152" x2="145" y2="185" stroke="#e74c3c" stroke-width="2" stroke-dasharray="5 3" class="flow" marker-end="url(#mr)"/>
  <text x="175" y="173" fill="#e74c3c" font-size="8" font-style="italic">existing conn</text>

  <!-- Instance OLD box -->
  <rect x="35" y="188" width="220" height="78" rx="9" fill="#fff0f0" stroke="#e74c3c" stroke-width="2" filter="url(#shadow)"/>
  <text x="145" y="208" text-anchor="middle" fill="#c0392b" font-size="10" font-weight="700">10.0.1.4  TERMINATED</text>
  <rect x="55" y="214" width="180" height="14" rx="3" fill="#fee2e2"/>
  <text x="145" y="225" text-anchor="middle" fill="#991b1b" font-size="7.5" font-weight="700">connection reset / ECONNREFUSED</text>
  <text x="145" y="243" text-anchor="middle" fill="#e74c3c" font-size="8">instance gone · requests fail</text>
  <text x="145" y="257" text-anchor="middle" fill="#e74c3c" font-size="8" font-style="italic">Client A keeps retrying same address</text>

  <!-- Status badge left -->
  <rect x="85" y="280" width="120" height="24" rx="7" fill="#fee2e2"/>
  <text x="145" y="296" text-anchor="middle" fill="#991b1b" font-size="9.5" font-weight="700">✗  Errors</text>

  <!-- ════ RIGHT COLUMN: Client B — new connection ════ -->

  <!-- Column header -->
  <rect x="415" y="18" width="370" height="28" rx="7" fill="#f0fff4" stroke="#86efac" stroke-width="1"/>
  <text x="600" y="36" text-anchor="middle" fill="#166534" font-size="9.5" font-weight="700">Client B  ·  new request at T = 70s</text>

  <!-- Client B box -->
  <rect x="460" y="58" width="180" height="38" rx="8" fill="white" stroke="#4f8ef7" stroke-width="1.8" filter="url(#shadow)"/>
  <text x="550" y="74" text-anchor="middle" fill="#4f8ef7" font-size="10" font-weight="700">Client B</text>
  <text x="550" y="88" text-anchor="middle" fill="#94a3b8" font-size="8">makes fresh request at T=70s</text>

  <!-- Arrow to DNS -->
  <line x1="550" y1="98" x2="550" y2="116" stroke="#4f8ef7" stroke-width="1.5" marker-end="url(#mb)"/>

  <!-- DNS query box -->
  <rect x="430" y="119" width="240" height="64" rx="7" fill="#eff6ff" stroke="#bfdbfe" stroke-width="1" filter="url(#shadow)"/>
  <text x="550" y="135" text-anchor="middle" fill="#1d4ed8" font-size="8.5" font-weight="700">DNS Resolution</text>
  <text x="550" y="150" text-anchor="middle" fill="#374151" font-size="8.5" font-family="monospace">api.example.com → 10.0.1.8</text>
  <circle cx="444" cy="165" r="5" fill="#27ae60"/>
  <text x="455" y="169" fill="#27ae60" font-size="8" font-style="italic">fresh · TTL 60s</text>

  <!-- Arrow down to instance -->
  <line x1="550" y1="186" x2="550" y2="207" stroke="#4f8ef7" stroke-width="2" stroke-dasharray="5 3" class="flow" marker-end="url(#mb)"/>
  <text x="580" y="196" fill="#4f8ef7" font-size="8" font-style="italic">new conn</text>

  <!-- Instance NEW box -->
  <rect x="440" y="210" width="220" height="78" rx="9" fill="#f0fff4" stroke="#27ae60" stroke-width="2" filter="url(#shadow)"/>
  <text x="550" y="230" text-anchor="middle" fill="#166534" font-size="10" font-weight="700">Instance · 10.0.1.8</text>
  <rect x="460" y="236" width="180" height="14" rx="3" fill="#dcfce7"/>
  <text x="550" y="247" text-anchor="middle" fill="#166534" font-size="7.5" font-weight="700">✓  healthy · new instance</text>
  <text x="550" y="265" text-anchor="middle" fill="#27ae60" font-size="8">200 OK</text>
  <text x="550" y="279" text-anchor="middle" fill="#27ae60" font-size="8" font-style="italic">DNS update immediately visible</text>

  <!-- Status badge right -->
  <rect x="490" y="302" width="120" height="24" rx="7" fill="#dcfce7"/>
  <text x="550" y="318" text-anchor="middle" fill="#166534" font-size="9.5" font-weight="700">✓  Working</text>

  <!-- Caption -->
  <line x1="200" y1="345" x2="600" y2="345" stroke="#e2e8f0" stroke-width="1"/>
  <text x="400" y="362" text-anchor="middle" fill="#1e293b" font-size="12" font-weight="700" font-family="Georgia,serif" font-style="italic">"DNS update is invisible to existing connections."</text>
  <text x="400" y="378" text-anchor="middle" fill="#94a3b8" font-size="9" font-style="italic">Client A stays pinned to a dead instance. Client B routes correctly. Same DNS, different outcomes.</text>
</svg>
