<svg width="800" height="420" viewBox="0 -25 800 420" xmlns="http://www.w3.org/2000/svg" font-family="'Segoe UI',system-ui,sans-serif">
  <defs>
    <style>
      @keyframes dash  { to { stroke-dashoffset: -20; } }
      @keyframes pulse { 0%,100% { opacity:1; } 50% { opacity:0.3; } }
      @keyframes err   { 0%,100% { opacity:0.95; } 50% { opacity:0.2; } }
      @keyframes ripple { 0% { r:46; opacity:0.6; } 100% { r:80; opacity:0; } }
      .flow   { animation: dash   1.8s linear      infinite; }
      .revoke { animation: dash   0.9s linear      infinite; }
      .blink  { animation: pulse  1.4s ease-in-out infinite; }
      .denied { animation: err    0.8s ease-in-out infinite; }
      .ring   { animation: ripple 1.6s ease-out    infinite; }
    </style>
    <linearGradient id="bg" x1="0" y1="0" x2="1" y2="1" gradientUnits="objectBoundingBox">
      <stop offset="0%" stop-color="#eef2ff"/>
      <stop offset="100%" stop-color="#f8fafc"/>
    </linearGradient>
    <linearGradient id="cp-grad" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#1e40af"/>
      <stop offset="100%" stop-color="#1d4ed8"/>
    </linearGradient>
    <linearGradient id="proxy-grad" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#2563eb"/>
      <stop offset="100%" stop-color="#3b82f6"/>
    </linearGradient>
    <marker id="arrowR" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#e74c3c"/>
    </marker>
    <marker id="arrowG" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#27ae60"/>
    </marker>
    <filter id="shadow">
      <feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#00000022"/>
    </filter>
    <filter id="glow-r">
      <feGaussianBlur stdDeviation="5" result="blur"/>
      <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
  </defs>

  <rect x="0" y="-25" width="800" height="420" fill="url(#bg)"/>

  <!-- dot grid -->
  <g fill="#c7d2fe" opacity="0.4">
    <g id="col"><circle cx="0" cy="0" r="1.5"/><circle cx="0" cy="40" r="1.5"/><circle cx="0" cy="80" r="1.5"/><circle cx="0" cy="120" r="1.5"/><circle cx="0" cy="160" r="1.5"/><circle cx="0" cy="200" r="1.5"/><circle cx="0" cy="240" r="1.5"/><circle cx="0" cy="280" r="1.5"/><circle cx="0" cy="320" r="1.5"/><circle cx="0" cy="360" r="1.5"/></g>
    <use href="#col" x="40"/><use href="#col" x="80"/><use href="#col" x="120"/><use href="#col" x="160"/>
    <use href="#col" x="200"/><use href="#col" x="240"/><use href="#col" x="280"/><use href="#col" x="320"/>
    <use href="#col" x="360"/><use href="#col" x="400"/><use href="#col" x="440"/><use href="#col" x="480"/>
    <use href="#col" x="520"/><use href="#col" x="560"/><use href="#col" x="600"/><use href="#col" x="640"/>
    <use href="#col" x="680"/><use href="#col" x="720"/><use href="#col" x="760"/>
  </g>

  <!-- ── Control Plane (top center) ── -->
  <rect x="284" y="14" width="232" height="62" rx="10" fill="url(#cp-grad)" filter="url(#shadow)"/>
  <text x="400" y="37" text-anchor="middle" fill="white" font-size="11" font-weight="700">Control Plane</text>
  <text x="400" y="52" text-anchor="middle" fill="#bfdbfe" font-size="8.5">policy store · allowlists · denylists</text>
  <text x="400" y="66" text-anchor="middle" fill="#93c5fd" font-size="8">gRPC / xDS push channel</text>

  <!-- ── REVOKE badge (pulsing) ── -->
  <g class="denied" filter="url(#glow-r)">
    <rect x="300" y="84" width="200" height="26" rx="6" fill="#e74c3c"/>
    <text x="400" y="101" text-anchor="middle" fill="white" font-size="11" font-weight="700">⚡ REVOKE PROPAGATING</text>
  </g>

  <!-- Ripple ring on control plane -->
  <circle cx="400" cy="45" r="46" fill="none" stroke="#e74c3c" stroke-width="2" class="ring" opacity="0"/>

  <!-- ── Push lines: Control Plane → 3 proxy instances ── -->
  <!-- to proxy 1 (left) -->
  <line x1="320" y1="76" x2="178" y2="182" stroke="#e74c3c" stroke-width="1.8" stroke-dasharray="6 4" class="revoke" marker-end="url(#arrowR)"/>
  <!-- to proxy 2 (center) -->
  <line x1="400" y1="76" x2="400" y2="182" stroke="#e74c3c" stroke-width="1.8" stroke-dasharray="6 4" class="revoke" marker-end="url(#arrowR)"/>
  <!-- to proxy 3 (right) -->
  <line x1="480" y1="76" x2="622" y2="182" stroke="#e74c3c" stroke-width="1.8" stroke-dasharray="6 4" class="revoke" marker-end="url(#arrowR)"/>

  <!-- ── Proxy Instance 1 (left) ── -->
  <circle cx="158" cy="198" r="40" fill="url(#proxy-grad)" filter="url(#shadow)" class="blink" opacity="0.15"/>
  <circle cx="158" cy="198" r="40" fill="url(#proxy-grad)" filter="url(#shadow)"/>
  <text x="158" y="193" text-anchor="middle" fill="white" font-size="9" font-weight="700">TrustBridge</text>
  <text x="158" y="205" text-anchor="middle" fill="#bfdbfe" font-size="8">proxy-1</text>
  <text x="158" y="218" text-anchor="middle" fill="#fca5a5" font-size="8" font-weight="600">policy updated</text>

  <!-- ── Proxy Instance 2 (center) ── -->
  <circle cx="400" cy="198" r="40" fill="url(#proxy-grad)" filter="url(#shadow)" class="blink" opacity="0.15"/>
  <circle cx="400" cy="198" r="40" fill="url(#proxy-grad)" filter="url(#shadow)"/>
  <text x="400" y="193" text-anchor="middle" fill="white" font-size="9" font-weight="700">TrustBridge</text>
  <text x="400" y="205" text-anchor="middle" fill="#bfdbfe" font-size="8">proxy-2</text>
  <text x="400" y="218" text-anchor="middle" fill="#fca5a5" font-size="8" font-weight="600">policy updated</text>

  <!-- ── Proxy Instance 3 (right) ── -->
  <circle cx="642" cy="198" r="40" fill="url(#proxy-grad)" filter="url(#shadow)" class="blink" opacity="0.15"/>
  <circle cx="642" cy="198" r="40" fill="url(#proxy-grad)" filter="url(#shadow)"/>
  <text x="642" y="193" text-anchor="middle" fill="white" font-size="9" font-weight="700">TrustBridge</text>
  <text x="642" y="205" text-anchor="middle" fill="#bfdbfe" font-size="8">proxy-3</text>
  <text x="642" y="218" text-anchor="middle" fill="#fca5a5" font-size="8" font-weight="600">policy updated</text>

  <!-- ── Blocked user approaching proxy-2 ── -->
  <circle cx="400" cy="300" r="36" fill="#fff0f0" stroke="#e74c3c" stroke-width="2" filter="url(#shadow)"/>
  <text x="400" y="294" text-anchor="middle" fill="#c0392b" font-size="9" font-weight="700">Terminated</text>
  <text x="400" y="306" text-anchor="middle" fill="#c0392b" font-size="9" font-weight="700">Employee</text>
  <text x="400" y="320" text-anchor="middle" fill="#e74c3c" font-size="8">cert revoked</text>

  <!-- Arrow: terminated user → proxy 2 (blocked) -->
  <line x1="400" y1="264" x2="400" y2="242" stroke="#e74c3c" stroke-width="2" stroke-dasharray="5 4" class="revoke" marker-end="url(#arrowR)"/>

  <!-- BLOCKED badge -->
  <g class="denied" filter="url(#glow-r)">
    <circle cx="400" cy="261" r="12" fill="#e74c3c"/>
    <text x="400" y="266" text-anchor="middle" fill="white" font-size="14" font-weight="700">✗</text>
  </g>

  <!-- ── Caption ── -->
  <line x1="160" y1="348" x2="640" y2="348" stroke="#e2e8f0" stroke-width="1"/>
  <text x="400" y="365" text-anchor="middle" fill="#1e293b" font-size="12" font-weight="700" font-family="Georgia,serif" font-style="italic">"Revoking access still takes hours. It shouldn't."</text>
  <text x="400" y="382" text-anchor="middle" fill="#94a3b8" font-size="9" font-style="italic">Control plane propagates revocation to every proxy instance in seconds.</text>
</svg>
